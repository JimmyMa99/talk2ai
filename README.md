# Voice Assistant with Real-time TTS

这是一个基于语音识别和实时文本转语音的智能对话助手。它能够实现语音输入、自动识别、智能对话，并通过多线程并行处理实现流畅的语音输出。

## 功能特点

- 实时语音录入与自动停止检测
- 智能语音识别（ASR）
- GPT 模型对话支持
- 实时流式文本转语音（TTS）
- 多线程并行处理 TTS 任务
- 有序的语音输出队列

## 依赖项

```bash
pip install openai sounddevice soundfile numpy requests
```

## 快速开始

1. 首先设置你的 API token：

```python
token = "your-api-token-here"
```

2. 运行程序：

```python
python voice_assistant.py
```

3. 使用方法：
   - 按回车开始录音
   - 说话，停顿 1.5 秒后自动结束录音
   - 等待助手回应
   - 按 Ctrl+C 退出程序

## 配置参数

可以通过修改以下参数来调整助手的行为：

```python
# 音频参数
self.sample_rate = 16000  # 采样率
self.silence_threshold = 0.02  # 静音检测阈值
self.silence_duration = 1.5  # 静音持续时间（秒）
self.chunk_size = 1024  # 音频块大小

# 对话参数
self.max_history = 5  # 对话历史最大长度

# 线程池参数
max_workers = 3  # 并行处理线程数
```

## 系统要求

- Python 3.8 或更高版本
- 麦克风输入设备
- 音频输出设备
- 稳定的网络连接

## 主要特性说明

### 智能录音
- 自动检测静音
- 智能停止录音
- 实时音频处理

### 语音识别
- 使用先进的 ASR 模型
- 支持中文识别
- 实时转写功能

### 智能对话
- 基于 GPT 模型
- 上下文理解
- 自然对话体验

### TTS 语音合成
- 并行处理机制
- 流式语音合成
- 有序播放控制

## 自定义提示语

可以通过修改 `system_prompt` 来自定义助手的行为特征：

```python
system_prompt = """你是一个智能语音助手。你的回答应该：
1. 简洁明了
2. 富有同理心
3. 准确专业
4. 在合适的时候适当幽默
请用自然、流畅的语气与用户交谈。"""
```

## 性能优化

- TTS 任务批处理机制
- 多线程并行处理
- 内存管理优化
- 资源自动释放

## 注意事项

1. API 密钥安全
   - 不要在代码中直接硬编码 API 密钥
   - 建议使用环境变量或配置文件

2. 资源使用
   - 监控系统资源使用情况
   - 适时调整并行处理参数

3. 错误处理
   - 网络连接异常处理
   - 音频设备异常处理

## 常见问题

1. 录音没有自动停止
   - 检查 silence_threshold 值是否合适
   - 调整 silence_duration 时间

2. 语音识别不准确
   - 确保安静的录音环境
   - 检查麦克风质量和设置

3. TTS 语音播放顺序错乱
   - 检查网络连接稳定性
   - 适当增加等待时间

## 后续优化方向

1. 支持更多语音模型
2. 添加语音情感识别
3. 优化对话上下文管理
4. 添加用户配置界面
5. 支持多语言切换

## License

MIT License

## 贡献指南

欢迎提交 Issues 和 Pull Requests 来改进这个项目。

## 联系方式

如有问题或建议，请通过 Issues 与我们联系。